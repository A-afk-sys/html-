
<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <title>&nbsp;</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0,viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="//y.gtimg.cn/mediastyle/mobile/project_v5/friend_news_v2.css?max_age=6048000&ver=20171122">
    <script>!function(e,t,n){function i(){var t;switch(n){case"height":var i=e.innerHeight||r.clientHeight;if(!i)return;t=100*(i/667)+"px";break;default:var i=e.innerWidth||r.clientWidth;if(!i)return;t=100*(i/375)+"px"}parseInt(t)>112&&(t="112px"),t&&r.style.fontSize!=t&&(r.style.fontSize=t)}if(e.addEventListener){var r=t.documentElement,a="orientationchange"in e?"orientationchange":"resize";t.addEventListener&&(e.addEventListener(a,i,!1),i(),setTimeout(function(){i()},500))}}(window,document,"width");</script>
</head>
<body>
    <article class="wrap">
        <div class="top_mask js_backtop" style="display:"></div>
        <section class="header header--base">
            <div class="header__bd">
                <h1 class="article_tit">今日合拍好友</h1>
                
            </div>
        </section>                      

        <section class="main js_main">
            <ul class="mod_playlist playlist--friend js_often_list">
                
                                     
            </ul>

        </section>

        <div class="mag_loading mag_loading--footer js_loading_more">
            <i class="icon_mag_loading"></i>
        </div>  

        
        <div class="quick_opt js_bottom_bar" style="display: none">
            
            <div class="playing js_playing_state">
                <div class="playing__bd">
                    <i class="icon_mag_loading black"></i>
                </div>
            </div> 
            <a class="all_friend js_go_friendpage" href="javascript:;" style="display: none">全部好友</a>                        
        </div>             
    </article>    
    <div class="get_more js_open_music" style="display:none" data-target="music" data-link="https://y.qq.com/m/client/music_headline/friendoften.html?_hidehd=1&_button=0">
        <div class="get_more__aside">
            <img class="get_more__img" src="//y.gtimg.cn/mediastyle/mod/mobile/img/logo.svg?max_age=604800" alt="QQ音乐">
        </div>
        <div class="get_more__bd">
            <p class="get_more__desc">探秘我与好友的音乐默契<br>就在QQ音乐·发现</p>
        </div>
        <a class="get_more__btn" href="javascript:;">打开</a>
    </div>
    <script src="//y.qq.com/music/h5/lib/js/zepto-1.0.min.js?max_age=2592000"></script>
    <script src="//y.qq.com/music/h5/lib/js/music-1.0.min.js?max_age=604800&v=20240709"></script>
    <script>
        (function () {
            !function(){if($.os.android){var i=window.navigator.userAgent,a=i.match(/isNorch\/(\d+)/i);if(a&&1==a[1]){var o=i.match(/topBar\/(\d+)/i);if(o){var d=o[1]||0;d>0&&(d/=window.devicePixelRatio||1,$(".top_mask").css({height:d}),$(".header").css({"padding-top":d}))}}}}();;
            function tj(e){e&&setTimeout(function(){M.tj.sendClick(pageParam.pagename+"."+e)})}function showTips(e,t){$.browser.music?M.client.open("ui","topTips",{type:t||0,message:e}):M.tips(e)}function initPageShare(e){e&&($.browser.music?e.isInit&&M.client.open("ui","setActionBtn",{type:"icon",content:"share"},function(t){tj("sharepage"),t&&0==t.code&&M.client.open("other","callShareWeb",{imgUrl:e.img,link:e.link,title:e.title,desc:e.desc},function(e){e&&tj(0==e.code?"sharepagesuccesscb":2==e.code?"sharepagecancelcb":"sharepageerrorcb")})}):M.share.init(e))}function requestData(e,t){M.ajax({url:location.protocol+"//u.y.qq.com/cgi-bin/musicu.fcg",data:{data:JSON.stringify(t||pageParam.cgiParam)},dataType:"json",interceptRequest:!1,success:function(t){t?0==t.code&&t.requestData&&0==t.requestData.code&&t.requestData.data?e&&e("",t):1e3==t.code||0==t.code&&t.requestData&&1e3==t.requestData.code?e&&e("nologin"):101010==t.code||0==t.code&&t.requestData&&101010==t.requestData.code?e&&e("noauth"):e&&e("server_error",t.code||0==t.code&&t.requestData&&t.requestData.code):e&&e("server_error")},error:function(){e&&e("network_error")}})}function doLogin(){$.browser.music?M.client.open("ui","login",{force:1},function(e){e&&0==e.code?location.reload():e&&2==e.code?(showTips("登录后才能查看数据哦",1),setTimeout(function(){M.client.open("ui","closeWebview")},200)):showTips("登录失败",1)}):M.user.login(function(){},!0)}function setLoadingState(e,t){var a=$(".js_loading_more");e?a.html("数据拉取失败，点击重试").addClass("js_retry").show():t?a.html('<i class="icon_mag_loading"></i>').removeClass("js_retry").show():a.removeClass("js_retry").hide()}function bindCommonEvent(){var e=!1;$(document).on("tap",".js_share_page",function(){tj("sharepage"),M.share.call()}).on("tap",".js_play_song",function(e){e&&e.stopImmediatePropagation();var t=$(this);"#icon_pause_thin"==t.find("svg use").attr("xlink:href")?(tj("pausesong."+t.data("type")),playerUtils.pause()):(tj("playsong."+t.data("type")),playerUtils.play(t.data("type"),t.attr("data-songid"),t.data("index"),t.attr("data-id")))}).on("tap",".js_playing_state",function(){$.browser.music&&M.client.open("media","getCurrentSong",{list:1},function(e){e&&0==e.code&&e.data&&(!e.data.list||e.data.list.length<=0?($(".js_playing_state").addClass("js_playing_state_disabled"),showTips("当前播放列表为空",1)):setTimeout(function(){M.client.open("ui","showPlayView")},0))}),tj("playstate.click")}).on("tap",".js_go_singer",function(e){e&&e.stopImmediatePropagation();var t=$(this).attr("data-singerid");t&&($.browser.music?M.client.open("ui","singer",{id:t}):setTimeout(function(){location.href=location.protocol+"//y.qq.com/w/singer.html?singerId="+t},200)),tj("gosingerpage.click")}).on("tap",".js_go_profile",function(e){e&&e.stopImmediatePropagation();var t=$(this).attr("data-uin");t?tj("gofirendprofile"):(t="",tj("goselfprofile")),!t||/^\d+$/.test(t)?M.client.open("ui","profile",{uin:t}):M.client.open("ui","profile",{encrypt_uin:t})}).on("tap",".js_praise_user",function(t){if(t&&t.stopImmediatePropagation(),e)return void showTips("正在请求中...",1);var a=$(this);a.hasClass("mod_praise")||(a=a.find(".mod_praise"));var i=a.attr("data-uin"),s=a.hasClass("praise--actived")?0:1,n=1==a.attr("data-top")?1:0;tj(0==s?"unpraiseuser":"praiseuser"),e=!0,requestData(function(t){if(e=!1,t)"nologin"==t?doLogin():showTips("操作失败",1);else{var n=a.find(".js_praise_num"),o=parseInt(n.text())||0;if(1==s?(a.addClass("ani_praise praise--actived"),o++):(a.removeClass("ani_praise praise--actived"),o--),n.text(o>0?o:""),$.browser.music&&(M.client.trigger&&M.client.trigger("custom_praise_user",{code:"0",data:{uin:i,operate:s,num:o}}),$.os.android)){var r=storageUtils.getItem("stationPraiseUser");try{r=JSON.parse(r)||[]}catch(e){r=[]}$.isArray(r)||(r=[]),r.push({uin:i,operate:s,num:o}),storageUtils.setItem("stationPraiseUser",JSON.stringify(r))}}},{requestData:{module:"friend_listen.FriendListenInfoServer",method:"favour",param:{uin:i,singer:a.data("singer"),flow:a.data("flow"),similar:a.data("similar")+"",operate:s,istop:n}}})}).on("tap",".js_link",function(){var e=$(this),t=e.data("link"),a=e.data("tj");t&&(t=M.fixUrl(t),tj(a),$.browser.music?M.client.open("ui","openUrl",{url:t}):setTimeout(function(){location.href=t},100))}).on("tap",".js_open_music",function(){var e=$(this).data("link"),t=$(this).data("target");e=e?M.fixUrl(e):location.protocol+"//y.qq.com/m/client/music_headline/station.html?_hidehd=1&_button=0","music"==t?M.client.open("ui","openUrl",{url:e}):M.checkInstall(function(t){1==t?M.client.open("ui","openUrl",{url:e}):setTimeout(function(){location.href=e},200)}),tj("openmusic")})}$.browser.music?$(".js_bottom_bar").show():($(".js_backtop").hide(),$("article.wrap").addClass("outside"),$(".js_open_music").show()),$.ajax({url:"//y.gtimg.cn/mediastyle/mobile/project_v5/img/magazine.svg",type:"GET",dataType:"html",crossDomain:"true",success:function(e){$("body").prepend(e)}});var playerUtils={_songlist:{hot:[],often:[]},_player:{},_sourceType:$.os.ios?"10000":"0",_changeState:function(e,t,a){var i;if($.isArray(a)&&t&&t.type==this._sourceType){var s=this._songlist.often;if(s){var n=-1;for(var o in s){var r=o.split("_")[1];if(r==t.id&&s.hasOwnProperty(o)){var l=0;if($.each(s[o],function(e,t){t&&a[e]&&t.songid==a[e].songid&&t.type==a[e].type&&l++}),l==s[o].length||l==a.length){n=o.split("_")[0];break}}}n>=0&&(i=$('.js_play_song[data-type="often"][data-index="'+n+'"]').find("svg use").attr("xlink:href","#icon_pause_thin"))}}e||i?(i=i||$('.js_play_song[data-songid="'+e+'"]').find("svg use").attr("xlink:href","#icon_pause_thin"),$(".js_play_song svg use").not(i).attr("xlink:href","#icon_play_thin"),$(".js_playing_state").addClass("playing--start").removeClass("js_playing_state_disabled")):($(".js_play_song svg use").attr("xlink:href","#icon_play_thin"),$(".js_playing_state").removeClass("playing--start"))},addPlayerStateListener:function(){var e=this;M.player.on("play pause ended",function(){var t=this;"playing"==t.state&&(t.songId||t.songUrl)?$.browser.music?M.client.open("media","getCurrentSong",{list:1},function(a){a&&0==a.code&&a.data?e._changeState(t.songId,a.data.source,a.data.list):e._changeState(t.songId,e._player.source)}):e._changeState(t.songId,e._player.source,e._player.song):e._changeState()})},play:function(e,t,a,i){this.pause();var s;if($.browser.music){if("hot"==e||"often"==e){if(s=this._songlist[e],!s||s.length<=0)return showTips("暂无可播放的歌曲");M.client.open("media","playSonglist",{song:s,index:a,hideLoading:1}),this._player.source=""}}else M.player.play(t,{hideLoading:1}),"often"==e?(this._player.song=this._songlist[e][a+"_"+i],this._player.source={type:this._sourceType,id:i}):(this._player.song=this._songlist[e],this._player.source="")},pause:function(){M.player.pause(),this._player.source="",this._player.song=[]},cacheSonglist:function(e,t){function a(e){if(!e)return 0;e=e.toString(2).split(""),e.pop(),e.reverse();for(var t={},a=["play_lq","play_hq","play_sq","down_lq","down_hq","down_sq","soso","fav","share","bgm","ring","sing","radio","try","give"],i=0;i<a.length;i++)t[a[i]]=parseInt(e[i],10)||0;return t.play=0,(t.play_lq||t.play_hq||t.play_sq)&&(t.play=1),t.play}function i(t){var i=[];return!t||t.length<=0?i:($.each(t,function(t,s){if(s=s.songinfo?s.songinfo:s,(s.id||s.songid)&&("often"!=e||a(s.action.switch))){var n={songid:s.id||s.songid,songmid:s.mid||s.songmid,songUrl:1==s.type?s.url:"",strMediaMid:s.file&&s.file.media_mid,songanme:s.name||s.songname,singer:s.singer,type:s.type};s.action&&(n.action={switch:s.action.switch,msgid:s.action.msgid,alert:s.action.alert,msgShare:s.action.msgshare,msgFav:s.action.msgfav,msgDown:s.action.msgdown,msgpay:s.action.msgpay}),s.album&&(n.albumid=s.album.id,n.albummid=s.album.mid,n.albumname=s.album.name),i.push(n)}}),i)}var s=this;"hot"!=e&&"often"!=e||(s._songlist[e]=s._songlist[e].concat(i(t)))},syncPlayState:function(){var e=this;$.browser.music&&M.client.open("media","getCurrentSong",{list:1},function(t){if(t&&0==t.code&&t.data)if(t.data.list&&t.data.list.length>0){if("playing"==t.data.state){var a=t.data.list[t.data.index];a&&a.songid&&e._changeState(a.songid,t.data.source,t.data.list)}}else $(".js_playing_state").addClass("js_playing_state_disabled")})},init:function(e,t){var a=this;a.addPlayerStateListener(),a.syncPlayState()}},storageUtils={localstorageEnable:function(){var e=!1;try{return localStorage.setItem("testlocalStorage",!0),localStorage.getItem("testlocalStorage")&&(e=!0),e}catch(t){return e}}(),setItem:function(e,t){storageUtils.localstorageEnable?localStorage.setItem(e,t):$.cookie.set(e,t)},getItem:function(e){return storageUtils.localstorageEnable?localStorage.getItem(e):$.cookie.get(e)}};"object"!=typeof pageParam&&(pageParam={}),M.ready(function(){if($.browser.music){if(M.client.open("ui","hideMiniPlayer"),$.os.android&&M.client.open("ui","refreshTitle",{hidden:"1"}),M.compare($.browser.appVer,"7.2")>=0){var e={hide:1,buttonType:2,colorType:2};M.compare($.browser.appVer,"7.9")>=0&&(e.buttonType=0,e.colorType=1,e.background=1),M.client.open("ui","setHeader",e)}M.compare($.browser.appVer,"7.8")>=0?M.client.open("ui","setStatusBar",{colorType:1}):M.compare($.browser.appVer,"7.5")>=0&&M.client.open("ui","setStatusBar",{hide:1}),M.client.on&&M.client.on("custom_praise_user",function(e){if(e&&0==e.code){if($.os.ios)t=e.data&&e.data.data&&[e.data.data];else{var t=storageUtils.getItem("stationPraiseUser");try{t=JSON.parse(t)}catch(e){t=null}}if(!t||!t.length)return;$.each(t,function(e,t){var a=t.uin,i=t.operate,s=t.num,n=$('.js_praise_user[data-uin="'+a+'"]'),o=n.find(".js_praise_num");n&&n.length&&(1==i?n.addClass("praise--actived"):n.removeClass("ani_praise praise--actived"),o.text(s>0?s:""))}),$.os.android&&storageUtils.setItem("stationPraiseUser","")}})}}),window.playerUtils=playerUtils;;
            function loadData(e){requestData(function(a,i){a||(pageParam.sin+=pageParam.pageSize,pageParam.cgiParam.requestData.param.sin+=pageParam.pageSize,pageParam.hasmore=i.requestData.data.more_flag,pageParam.cgiParam.requestData.param.last_uin=i.requestData.data.last_uin),e&&e(a,i)})}var pageParam={pageSize:20,sin:0,pagename:"music_headline_friendoften",hasmore:1,isInit:!1,cgiParam:{requestData:{module:"friend_listen.FriendListenInfoServer",method:"get_similar_friends",param:{sin:0,pagesize:20,last_uin:0}}}},pageIndex={_tpl:{list:function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)for(var item,i=0;i<list.length;i++)if(item=list[i]){__p+='\r\n<li class="playlist__item js_link" data-tj="gosimilardetailpage" data-link="https://y.qq.com/m/client/music_headline/similardetail.html?_hidehd=1&_button=0&uin='+(null==(__t=item.encrypt_uin)?"":__t)+(null==(__t=index&&0==i?"&top=1":"")?"":__t)+'">\r\n    <div class="playlist__box " >\r\n        <div class="playlist__aside">\r\n            <img class="playlist__img" src="'+__e(item.logo)+'" alt="" onerror="javascript:this.src=\'//y.gtimg.cn/mediastyle/global/img/person_300.png?max_age=2592000\';this.onerror=null;">\r\n        </div>\r\n        \r\n        <div class="playlist__bd" >\r\n            <h3 class="playlist__tit">\r\n                <span class="playlist__ellipsis">'+__e(item.nick||item.uin)+"</span>\r\n                ",index&&0==i&&(__p+='\r\n                <span class="label_most_match">最合拍</span>\r\n                '),__p+='\r\n            </h3>\r\n            <div class="friend_listen__similarity" ><span class="playlist__ellipsis">与我的相似度 '+__e(Math.ceil(item.similar))+"%</span></div>\r\n        </div>\r\n        ";var flowTags=[],singerTags=[],tags=[];if(item.vec_flow&&item.vec_flow.length)for(var k=0;k<item.vec_flow.length;k++)item.vec_flow[k]&&item.vec_flow[k].name&&(flowTags.push(item.vec_flow[k].name),tags.push(item.vec_flow[k]));if(item.vec_singer&&item.vec_singer.length)for(var k=0;k<item.vec_singer.length;k++)item.vec_singer[k]&&item.vec_singer[k].name&&(singerTags.push(item.vec_singer[k].name),tags.push(item.vec_singer[k]));if(__p+='\r\n        <div class="playlist__praise">\r\n            <!-- 点赞动画:ani_praise -->\r\n            <div class="mod_praise js_praise_user '+__e(item.is_favour?"praise--actived":"")+'" data-uin="'+__e(item.encrypt_uin)+'" data-flow="'+__e(flowTags.join(","))+'" data-singer="'+__e(singerTags.join(","))+'" data-similar="'+__e(Math.ceil(item.similar))+'" data-top="'+__e(index&&0==i?1:0)+'">\r\n                <span class="praise__number js_praise_num">'+__e(item.favour||"")+'</span>\r\n                <div class="praise_bd">\r\n                    <span class="praise__add">+1</span>\r\n                    <svg class="praise__icon icon_svg"><use xlink:href="#icon_praise_thin"></use></svg>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    ',index&&0==i){if(__p+="\r\n        ",tags&&tags.length){__p+='\r\n            <div class="playlist__tag">我们都喜欢：\r\n            ';for(var count=0,k=0;k<tags.length&&k<3&&(count+=(tags[k].name||"").length,!(2==k&&count>12));k++)tags[k]&&tags[k].name&&(__p+='\r\n            <span class="mod_tag">'+__e(tags[k].name)+"</span>\r\n            ");__p+="\r\n            </div>\r\n        \r\n        "}__p+="\r\n    "}__p+="\r\n</li>\r\n"}return __p}},render:function(e,a,i){if("curDate"==e&&a){var t=new Date(parseInt(a)),n="";t&&"Invalid Date"!=t&&(n=t.getFullYear()+"·"+(t.getMonth()+1)+"·"+t.getDate()),$(".js_cur_date").text(n)}else if("empty"==e)$(".js_main").prepend('<p style="padding-left: 20px">暂无好友常听数据</p>');else if("playlist"==e){var s=this._tpl.list({list:a,index:i});$(".js_often_list").append(s)}},showPage:function(e,a){var i=this;return pageParam.hasmore?void loadData(function(t,n){if(t)if("nologin"==t)doLogin();else{if("noauth"==t)return M.user.auth&&M.user.auth({cgiInfo:"friend_listen.FriendListenInfoServer.get_similar_friends"});var s="服务器繁忙，数据加载失败！";"network_error"==t?s="网络繁忙，数据加载失败！":n&&(s+="错误码："+n),showTips(s,1)}else if(i.render("curDate",n.ts),n.requestData&&n.requestData.data&&n.requestData.data.vec_often&&n.requestData.data.vec_often.length>0?(i.render("playlist",$.extend(!0,[],n.requestData.data.vec_often),"index"==e),"index"==e&&playerUtils.init(),playerUtils.cacheSonglist("often",n.requestData.data.vec_often),"more"==e&&playerUtils.syncPlayState()):"index"==e&&i.render("empty"),"index"==e){pageParam.isInit=!0;var r=n.requestData&&n.requestData.data&&n.requestData.data.vec_often&&n.requestData.data.vec_often[0];r&&(img=r.logo,initPageShare({title:"音乐默契测试丨在音乐的世界与我最合拍好友是"+r.nick+"，你的呢？",link:location.href,desc:"想知道你的合拍好友是谁吗？",img:img,isInit:!1,onshare:function(){tj("sharepage")}}),$.browser.music&&$(".js_share_page").parent().show())}a&&a(),setLoadingState(t,pageParam.hasmore)}):void(a&&a())},init:function(){function e(){window._currentScrollTop=0;var e=-1;$(window).on("scroll",function(a){e&&clearTimeout(e),e=setTimeout(function(){window._currentScrollTop=document.body.scrollTop||document.documentElement.scrollTop,window._currentScrollTop+document.documentElement.clientHeight>=document.documentElement.scrollHeight&&!i&&(i=!0,tj("morelist.scroll"),pageIndex.showPage("more",function(){i=!1}))},50)})}var a=this;if(!M.user.isLogin()||M.user.getUin()<=1e4)return doLogin();$.browser.music&&M.compare($.browser.appVer,"7.7")>=0&&$(".js_go_friendpage").show(),a.showPage("index");var i;bindCommonEvent(),$(document).on("tap",".js_retry",function(){i||(setLoadingState("",1),pageParam.isInit?(i=!0,pageIndex.showPage("more",function(){i=!1})):pageIndex.showPage("index"))}).on("tap",".js_go_friendpage",function(){M.client.open("ui","profile",{page:"friends"}),tj("goallfriend")}),e()}};pageIndex.init();;
        })();
    </script> 

</body>
</html>
